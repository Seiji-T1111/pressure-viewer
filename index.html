<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>体調・気分ビューアー</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #controls { margin-bottom: 10px; }
    canvas { max-width: 100%; }
  </style>
</head>
<body>

<h1>体調・気分ビューアー</h1>

<div id="controls">
  <label for="periodSelect">表示期間：</label>
  <select id="periodSelect">
    <option value="7">7日間</option>
    <option value="14" selected>14日間</option>
    <option value="30">1か月</option>
    <option value="90">3か月</option>
  </select>
</div>

<canvas id="chart"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const rawData = [
  // ここに元のデータを配列形式で入れる
  // 例: { date: '2025-08-01', mood: 3, memo: '普通' },
];

const ctx = document.getElementById('chart').getContext('2d');
let chart;

function renderChart(days) {
  const now = new Date();
  const cutoff = new Date(now.getTime() - (days - 1) * 24 * 60 * 60 * 1000);
  const filtered = rawData.filter(d => new Date(d.date) >= cutoff);
  const labels = filtered.map(d => d.date);
  const data = filtered.map(d => d.mood);

  if(chart) chart.destroy();

  chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [{
        label: '気分',
        data: data,
        borderColor: 'blue',
        backgroundColor: 'rgba(0,0,255,0.1)',
        fill: true,
        tension: 0.2
      }]
    },
    options: {
      scales: { y: { min: 1, max: 5, ticks: { stepSize: 1 } } },
      plugins: { legend: { display: false } }
    }
  });
}

document.getElementById('periodSelect').addEventListener('change', e => {
  renderChart(parseInt(e.target.value));
});

// 初期表示
renderChart(parseInt(document.getElementById('periodSelect').value));
</script>

</body>
</html>
